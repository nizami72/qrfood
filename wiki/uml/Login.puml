@startuml
' Automatically numbers the steps for clarity
autonumber

' Define participants in the sequence
participant User
participant "Login Component" as LoginComponent
participant AuthContext
participant API
participant SuperAdminRoute
participant TokenRefresh
participant Window

== User Login Flow ==

User -> LoginComponent: Enter credentials
LoginComponent -> API: POST /api/auth/login
API --> LoginComponent: Return JWT token
LoginComponent -> AuthContext: Set token via login()
LoginComponent -> Window: Dispatch 'login-success' event
Window -> TokenRefresh: Set up refresh timer

== Token Refresh Cycle ==

note over TokenRefresh
  Periodically checks token
  expiration and refreshes it.
end note

TokenRefresh -> API: POST /api/auth/refresh-token
API --> TokenRefresh: Return new token
TokenRefresh -> Window: Dispatch 'token-refreshed' event
Window -> AuthContext: Update token state

== Protected Route Access ==

User -> SuperAdminRoute: Navigate to protected route
SuperAdminRoute -> AuthContext: Get token and isAuthenticated
AuthContext --> SuperAdminRoute: Return token (null issue occurs here)
' Self-call for internal logic check
SuperAdminRoute -> SuperAdminRoute: Check SUPER_ADMIN role

@enduml
